(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{441:function(s,t,a){"use strict";a.r(t);var e=a(17),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"ubuntu下安装gcc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu下安装gcc"}},[s._v("#")]),s._v(" Ubuntu下安装GCC")]),s._v(" "),t("p",[s._v("为了支持新的"),t("code",[s._v("c++")]),s._v("标准，需要安装新的"),t("code",[s._v("GCC")]),s._v("，安装步骤如下.")]),s._v(" "),t("h2",{attrs:{id:"查看官方安装指导"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看官方安装指导"}},[s._v("#")]),s._v(" 查看官方安装指导")]),s._v(" "),t("p",[t("code",[s._v("GCC")]),s._v("版本查看,截止"),t("code",[s._v("20240324")]),s._v("，"),t("code",[s._v("gcc")]),s._v("最新的版本为"),t("code",[s._v("13.2")]),s._v("，支持到了"),t("code",[s._v("c++23")]),s._v("标准。")]),s._v(" "),t("p",[s._v("版本发布信息可以参考："),t("a",{attrs:{href:"https://gcc.gnu.org/releases.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("GCC Releases"),t("OutboundLink")],1),s._v("查看。")]),s._v(" "),t("p",[s._v("安装指导参考的网页为:【"),t("a",{attrs:{href:"https://gcc.gnu.org/install/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("GCC Installation Instructions"),t("OutboundLink")],1),s._v("】")]),s._v(" "),t("ul",[t("li",[s._v("检查安装依赖,")]),s._v(" "),t("li",[s._v("下载源码，可使用"),t("code",[s._v("git")]),s._v("命令克隆")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone git://gcc.gnu.org/git/gcc.git\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有分支")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" branch "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有标签")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" tag "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n")])])]),t("p",[s._v("有时候，国内访问"),t("code",[s._v("gcc")]),s._v("放置代码的"),t("code",[s._v("git")]),s._v("仓库速度会很慢，这个时候可以从开源中国的码云平台上下载，")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("https://gitee.com/mirrors/gcc.git\n")])])]),t("p",[s._v("这个是国内镜像，可以加速下载速度。")]),s._v(" "),t("ul",[t("li",[s._v("下载源码后，切入源码目录，执行如下命令下载依赖")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("./contrib/download_prerequisites\n")])])]),t("ul",[t("li",[s._v("配置，可在源码仓库下新建"),t("code",[s._v("build")]),s._v("目录，然后切换到"),t("code",[s._v("build")]),s._v("目录下执行如下命令进行配置。")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/configure --enable-languages"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("c,c++ "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/gcc-13.2.0 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--host")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("x86_64-pc-linux-gnu "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/xx/data/sw/gcc13 --disable-multilib\n")])])]),t("p",[s._v("更多的配置参数可以参考页面"),t("a",{attrs:{href:"https://gcc.gnu.org/install/configure.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://gcc.gnu.org/install/configure.html"),t("OutboundLink")],1)]),s._v(" "),t("ul",[t("li",[s._v("安装")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])])]),t("ul",[t("li",[s._v("验证安装")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("/usr/local/gcc-13.2.0/bin/gcc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--version")]),s._v("\n")])])]),t("ul",[t("li",[s._v("设置环境变量")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(":/usr/local/gcc-13.2.0/bin\n")])])]),t("ul",[t("li",[s._v("卸载")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /usr/local/gcc-13.2.0\n")])])]),t("h2",{attrs:{id:"错误"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#错误"}},[s._v("#")]),s._v(" 错误")]),s._v(" "),t("h3",{attrs:{id:"缺少gmp库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缺少gmp库"}},[s._v("#")]),s._v(" 缺少"),t("code",[s._v("gmp")]),s._v("库")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("xx@xx-rob:~/data/code/gcc$ ./configure --enable-languages"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("c,c++ "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/gcc-13.2.\n\nchecking "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the correct version of gmp.h"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". no\nconfigure: error: Building GCC requires GMP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v("+, MPFR "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.1")]),s._v(".0+ and MPC "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v(".0+.\nTry the --with-gmp, --with-mpfr and/or --with-mpc options to specify\ntheir locations.  Source code "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" these libraries can be found at\ntheir respective hosting sites as well as at\n")])])]),t("p",[s._v("解决方法，先执行命令：")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("xx@xx-rob:~/data/code/gcc$ ./contrib/download_prerequisites\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-03-21 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":31:18 URL:http://gcc.gnu.org/pub/gcc/infrastructure/gmp-6.2.1.tar.bz2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2493916")]),s._v("/2493916"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gmp-6.2.1.tar.bz2"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-03-21 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":33:48 URL:http://gcc.gnu.org/pub/gcc/infrastructure/mpfr-4.1.0.tar.bz2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1747243")]),s._v("/1747243"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mpfr-4.1.0.tar.bz2"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-03-21 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":34:29 URL:http://gcc.gnu.org/pub/gcc/infrastructure/mpc-1.2.1.tar.gz "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("838731")]),s._v("/838731"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mpc-1.2.1.tar.gz"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-03-21 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":35:49 URL:http://gcc.gnu.org/pub/gcc/infrastructure/isl-0.24.tar.bz2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2261594")]),s._v("/2261594"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"isl-0.24.tar.bz2"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ngmp-6.2.1.tar.bz2: OK\nmpfr-4.1.0.tar.bz2: OK\nmpc-1.2.1.tar.gz: OK\nisl-0.24.tar.bz2: OK\nAll prerequisites downloaded successfully.\n")])])]),t("h3",{attrs:{id:"缺少32位开发库libc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缺少32位开发库libc"}},[s._v("#")]),s._v(" 缺少"),t("code",[s._v("32")]),s._v("位开发库"),t("code",[s._v("libc")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("/usr/bin/ld: cannot "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-lgcc")]),s._v("\ncollect2: error: ld returned "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" status\nconfigure: error: I suspect your system does not have "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("-bit development libraries "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("libc and headers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(". If you have them, rerun configure with --enable-multilib. If you "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" not have them, and want to build a "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("-bit-only compiler, rerun configure with --disable-multilib.\n")])])]),t("p",[s._v("解决办法：")]),s._v(" "),t("ul",[t("li",[s._v("安装"),t("code",[s._v("32")]),s._v("位"),t("code",[s._v("libc")]),s._v("库文件")]),s._v(" "),t("li",[t("code",[s._v("./configure")]),s._v("时使用参数"),t("code",[s._v("--disable-multilib")]),s._v("禁用编译"),t("code",[s._v("32")]),s._v("位平台上可以使用的库")])]),s._v(" "),t("h3",{attrs:{id:"g-error-gengtype-lex-c-no-such-file-or-directory"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#g-error-gengtype-lex-c-no-such-file-or-directory"}},[s._v("#")]),s._v(" g++: error: gengtype-lex.c: No such file or directory")]),s._v(" "),t("p",[s._v("编译过程中报错：")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" and I found the Makefile "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" my objdir directory. I try "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j4")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" and found\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" g++: error: gengtype-lex.c: No such "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or directory\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" g++: fatal error: no input files\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Could you "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" me with this?\n")])])]),t("p",[s._v("解决办法：")]),s._v(" "),t("p",[s._v("缺少"),t("code",[s._v("flex")]),s._v("库文件，手动安装：")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" flex\n")])])]),t("h3",{attrs:{id:"编译报错-libstdc-so-6-version-glibcxx-3-4-20-not-found"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译报错-libstdc-so-6-version-glibcxx-3-4-20-not-found"}},[s._v("#")]),s._v(" 编译报错：libstdc++.so.6: version `GLIBCXX_3.4.20' not found")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lib/libstdc++.so.6: version `GLIBCXX_3.4.20' not found (required by /usr/lib/x86_64-linux-gnu/libproxy.so.1)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Failed to load module: /usr/lib/x86_64-linux-gnu/gio/modules/libgiolibproxy.so")]),s._v("\n")])])]),t("p",[s._v("运行程序时报以上错误，这说明"),t("code",[s._v("GCC")]),s._v("使用的依赖库太老了，可以使用以下命令查看"),t("code",[s._v("c++")]),s._v("库支持的"),t("code",[s._v("GLIBCXX")]),s._v("版本，")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("strings /usr/lib/libstdc++.so.6 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" GLIBCXX\n")])])]),t("p",[s._v("解决办法，安装新版本的"),t("code",[s._v("gcc")]),s._v("，并在新版本的"),t("code",[s._v("lib64")]),s._v("文件夹下找到"),t("code",[s._v("libstdc++")]),s._v("库文件，将该路径添加到链接库路径:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LD_LIBRARY_PATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LD_LIBRARY_PATH")]),s._v(":/cur/xx\n")])])]),t("h3",{attrs:{id:"reference"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[s._v("#")]),s._v(" reference")]),s._v(" "),t("blockquote",[t("p",[t("a",{attrs:{href:"https://www.spinics.net/lists/gcchelp/msg50998.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("1.https://www.spinics.net/lists/gcchelp/msg50998.html"),t("OutboundLink")],1),t("br"),s._v(" "),t("a",{attrs:{href:"https://stackoverflow.com/questions/44773296/libstdc-so-6-version-glibcxx-3-4-20-not-found",target:"_blank",rel:"noopener noreferrer"}},[s._v("2.https://stackoverflow.com/questions/44773296/libstdc-so-6-version-glibcxx-3-4-20-not-found"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);