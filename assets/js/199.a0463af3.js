(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{512:function(s,t,a){"use strict";a.r(t);var e=a(17),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"linux文件权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux文件权限"}},[s._v("#")]),s._v(" linux文件权限")]),s._v(" "),t("p",[s._v("用户权限是通过创建用户时分配的用户"),t("code",[s._v("ID")]),s._v("（"),t("code",[s._v("User ID")]),s._v("，通常缩写为"),t("code",[s._v("UID")]),s._v("）来跟踪的。")]),s._v(" "),t("h2",{attrs:{id:"用户账户处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户账户处理"}},[s._v("#")]),s._v(" 用户账户处理")]),s._v(" "),t("p",[s._v("先来看一下"),t("code",[s._v("Linux")]),s._v("是怎样处理用户账户的。")]),s._v(" "),t("p",[t("code",[s._v("Linux")]),s._v("系统使用专门的文件"),t("code",[s._v("/etc/passwd")]),s._v("来将用户的登录名匹配到对应的"),t("code",[s._v("UID")]),s._v("值。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/passwd\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# root:x:0:0:root:/root:/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin:x:2:2:bin:/bin:/usr/sbin/nologin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sys:x:3:3:sys:/dev:/usr/sbin/nologin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sync:x:4:65534:sync:/bin:/bin/sync")]),s._v("\n\n")])])]),t("p",[t("code",[s._v("Linux")]),s._v("系统会为各种各样的功能创建不同的用户账户，而这些账户并不是真的用户。这些账户叫作系统账户，是系统上运行的各种服务进程访问资源用的特殊账户, 这样可以防止有人攻入某个服务获取"),t("code",[s._v("root")]),s._v("账号后访问整个系统。")]),s._v(" "),t("p",[t("code",[s._v("Linux")]),s._v("为系统账户预留了"),t("code",[s._v("500")]),s._v("以下的"),t("code",[s._v("UID")]),s._v("值。大多数"),t("code",[s._v("Linux")]),s._v("系统会从"),t("code",[s._v("500")]),s._v("开始，将第一个可用"),t("code",[s._v("UID")]),s._v("分配给这个账户")]),s._v(" "),t("p",[t("code",[s._v("/etc/shadow")]),s._v("文件为系统上的每个用户账户都保存了一条记录,对"),t("code",[s._v("Linux")]),s._v("系统密码管理提供了更多的控制。")]),s._v(" "),t("p",[t("strong",[s._v("添加新用户")]),s._v(": 向"),t("code",[s._v("Linux")]),s._v("系统添加新用户使用"),t("code",[s._v("useradd")]),s._v("命令，"),t("code",[s._v("useradd")]),s._v(" 命令使用系统的默认值以及命令行参数来设置用户账户。")]),s._v(" "),t("p",[s._v("默认值:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" rx@rx-rob:~$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-D")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# GROUP=100")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# HOME=/home")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# INACTIVE=-1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# EXPIRE=")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# SHELL=/bin/sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# SKEL=/etc/skel")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CREATE_MAIL_SPOOL=no")]),s._v("\n")])])]),t("p",[s._v("默认情况下， useradd 命令不会创建HOME目录，但是 -m 命令行选项会使其创建HOME目录。创建新用户:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" rob\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-al")]),s._v(" /home/rob\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .bash_logout  .bashrc       .profile      模板/  ")]),s._v("\n")])])]),t("p",[t("code",[s._v("useradd")]),s._v("命令创建了新HOME目录，并将"),t("code",[s._v("/etc/skel")]),s._v("目录中的文件复制了过来。")]),s._v(" "),t("p",[t("strong",[s._v("删除用户")]),s._v(" ： "),t("code",[s._v("userdel")]),s._v(" 可以满足这个需求。默认情况下， "),t("code",[s._v("userdel")]),s._v(" 命令会只"),t("br"),s._v("\n删除"),t("code",[s._v("/etc/passwd")]),s._v("文件中的用户信息，而不会删除系统中属于该账户的任何文件。加上 "),t("code",[s._v("-r")]),s._v(" 参数， "),t("code",[s._v("userdel")]),s._v(" 会删除用户的HOME目录以及邮件目录。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("userdel")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" rob\n")])])]),t("p",[t("strong",[s._v("修改用户")]),s._v("：修改已有用户账户的信息的命令有：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("命令")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("作用")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("usermod")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("修改用户账户的字段，还可以指定主要组以及附加组的所属关系")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("passwd")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("修改已有用户的密码")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("chpasswd")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("从文件中读取登录名密码对，并更新密码")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("chage")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("修改密码的过期日期")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("chfn")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("修改用户账户的备注信息")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("chsh")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("修改用户账户的默认登录shell")])])])]),s._v(" "),t("h2",{attrs:{id:"用户组"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户组"}},[s._v("#")]),s._v(" 用户组")]),s._v(" "),t("p",[s._v("用户账户在控制单个用户安全性方面很好用，在涉及共享资源的一组用户时需要使用组设置。")]),s._v(" "),t("p",[s._v("组信息保存在系统的"),t("code",[s._v("/etc/group")]),s._v("文件中。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/group\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4个字段 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 组名 组密码 GID 属于该组的用户列表")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# root:x:0:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# daemon:x:1:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bin:x:2:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sys:x:3:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# adm:x:4:syslog,lx")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tty:x:5:syslog")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# disk:x:6:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lp:x:7:")]),s._v("\n")])])]),t("p",[s._v("和"),t("code",[s._v("UID")]),s._v("一样，"),t("code",[s._v("GID")]),s._v("在分配时也采用了特定的格式。系统账户用的组通常会分配低于"),t("code",[s._v("500")]),s._v("的"),t("code",[s._v("GID")]),s._v("值，而用户组的"),t("code",[s._v("GID")]),s._v("则会从"),t("code",[s._v("500")]),s._v("开始分配。")]),s._v(" "),t("p",[s._v("不能通过直接修改"),t("code",[s._v("/etc/group")]),s._v("文件来添加用户到一个组，要用 "),t("code",[s._v("usermod")]),s._v(" 命令。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-G")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" rob\n")])])]),t("p",[t("code",[s._v("groupadd")]),s._v("命令可在系统上创建新组。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" shared\n")])])]),t("h2",{attrs:{id:"文件权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件权限"}},[s._v("#")]),s._v(" 文件权限")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# drwxr-xr-x  6 rob   rob    4096 11月 11 12:39 vscode-cpptools")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -rw-rw-r--  1 rob   rob     762 11月 10 21:58 wget-log")]),s._v("\n")])])]),t("p",[s._v("输出结果的第一个字段就是描述文件和目录权限的编码。")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-")]),s._v("代表文件")]),s._v(" "),t("li",[t("code",[s._v("d")]),s._v("代表目录")]),s._v(" "),t("li",[t("code",[s._v("l")]),s._v("代表链接")]),s._v(" "),t("li",[t("code",[s._v("c")]),s._v("代表字符型设备")]),s._v(" "),t("li",[t("code",[s._v("b")]),s._v("代表块设备")]),s._v(" "),t("li",[t("code",[s._v("n")]),s._v("代表网络设备")])]),s._v(" "),t("p",[s._v("之后有3组三字符的编码,每一组定义了3种访问权限：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("r")]),s._v(" 代表对象是可读")]),s._v(" "),t("li",[t("code",[s._v("w")]),s._v(" 代表对象是可写")]),s._v(" "),t("li",[t("code",[s._v("x")]),s._v(" 代表对象是可执行")])]),s._v(" "),t("p",[s._v("这3组权限分别对应对象的3个安全级别：")]),s._v(" "),t("ul",[t("li",[s._v("对象的所有者")]),s._v(" "),t("li",[s._v("对象同组的成员")]),s._v(" "),t("li",[s._v("系统其他用户")])]),s._v(" "),t("p",[t("strong",[s._v("默认文件权限")]),s._v("，"),t("code",[s._v("umask")]),s._v(" 命令用来设置所创建文件和目录的默认权限。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("rob@lx-rob:~$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v("\n0002\n")])])]),t("p",[t("strong",[s._v("修改权限")]),s._v("，"),t("code",[s._v("chmod")]),s._v(" 命令用来改变文件和目录的安全性设置。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("760")]),s._v(" test.txt\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("760")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])])]),t("p",[t("strong",[s._v("改变所属关系")]),s._v("，使用命令"),t("code",[s._v("chgrp")]),s._v("或"),t("code",[s._v("chown")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" Job newfile\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" shared newfile\n")])])]),t("p",[s._v("SGID位会强制某个目录下创建的新文件或目录都沿用该父目录的属组，而不是创建这些文件的用户的属组。这可以为系统的用户之间共享文件提供一个简便的途径。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" g+s textfile\n")])])]),t("InArticleAdsense",{attrs:{"data-ad-client":"ca-pub-8685746128991385","data-ad-slot":"2974191661"}})],1)}),[],!1,null,null,null);t.default=n.exports}}]);