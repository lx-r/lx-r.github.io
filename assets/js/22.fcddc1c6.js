(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{331:function(s,t,a){s.exports=a.p+"assets/img/ntfx.38966750.png"},566:function(s,t,a){"use strict";a.r(t);var e=a(17),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"ntfsfix命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ntfsfix命令"}},[s._v("#")]),s._v(" ntfsfix命令")]),s._v(" "),t("h2",{attrs:{id:"问题背景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题背景"}},[s._v("#")]),s._v(" 问题背景")]),s._v(" "),t("p",[s._v("最近遇到了一个什么问题呢，linux自动挂载硬盘后，变成了只读文件系统，无法创建和修改文件"),t("br"),s._v("\n查看挂载信息，")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" data\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /dev/sdb3 on /media/lx/data type fuseblk (rw,nosuid,nodev,relatime,user_id=0,group_id=0,default_permissions,allow_other,blksize=4096,uhelper=udisks2)")]),s._v("\n\n")])])]),t("p",[s._v("手动umount然后mount时报错，")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The disk contains an unclean file system (0, 0).")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Metadata kept in Windows cache, refused to mount.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Falling back to read-only mount because the NTFS partition is in an")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# unsafe state. Please resume and shutdown Windows fully (no hibernation")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or fast restarting.)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Could not mount read-write, trying read-only")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ntfs-3g-mount: failed to access mountpoint /media/lx/data: No such file or directory")]),s._v("\n\n")])])]),t("p",[s._v("以上报错的背景是，这个电脑是双系统，这个分区在"),t("code",[s._v("windows")]),s._v("下也能访问，从报错信息来看是"),t("code",[s._v("Metadata kept in Windows cache, refused to mount.")]),s._v("磁盘的元数据没有被正常的释放。查了很多资料都没有讲明白。")]),s._v(" "),t("h2",{attrs:{id:"解决办法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[s._v("#")]),s._v(" 解决办法")]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("ubuntu")]),s._v("论坛上搜到一个有用的回答"),t("code",[s._v("https://askubuntu.com/questions/462381/cant-mount-ntfs-drive-the-disk-contains-an-unclean-file-system")])]),s._v(" "),t("p",[t("strong",[s._v("使用"),t("code",[s._v("ntfsfix")]),s._v("命令来对有问题的分区进行修复")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ntfsfix /dev/sdb3\n")])])]),t("p",[s._v("修复后，再次挂载")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" /dev/sdb3 /media/mount_point\n")])])]),t("h2",{attrs:{id:"命令详解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令详解"}},[s._v("#")]),s._v(" 命令详解")]),s._v(" "),t("p",[t("code",[s._v("ntfsfix")]),s._v("是一个用于修复NTFS文件系统的命令行工具，属于"),t("code",[s._v("ntfs-3g")]),s._v("软件包。它主要用于在"),t("code",[s._v("Linux")]),s._v("环境中处理"),t("code",[s._v("NTFS")]),s._v("分区的常见问题，尤其是在"),t("code",[s._v("Windows")]),s._v("系统未正常关机后，导致"),t("code",[s._v("NTFS")]),s._v("分区出现不一致或“脏”标志的情况。")]),s._v(" "),t("p",[s._v("ntfsfix命令可以执行以下操作：")]),s._v(" "),t("ul",[t("li",[s._v("修复基本的NTFS不一致性")]),s._v(" "),t("li",[s._v("重置NTFS日志文件")]),s._v(" "),t("li",[s._v("清除“脏”标志，使得NTFS分区可以在Linux下正常挂载"),t("br"),s._v("\n安装方法"),t("br"),s._v("\n在使用ntfsfix之前，需要确保ntfs-3g软件包已安装。可以通过以下命令在Ubuntu或Debian系统上安装：")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ntfs-3g\n")])])]),t("p",[t("code",[s._v("NTFS（New Technology File System）")]),s._v("是由微软开发的一种文件系统，主要用于"),t("code",[s._v("Windows NT")]),s._v("及其后续版本（如"),t("code",[s._v("Windows 2000")]),s._v("、"),t("code",[s._v("XP")]),s._v("、"),t("code",[s._v("Vista")]),s._v("、7、8和10）。它于1993年首次引入，旨在取代较旧的"),t("code",[s._v("FAT")]),s._v("（File Allocation Table）文件系统，提供更高的性能、可靠性和安全性。")]),s._v(" "),t("p",[s._v("报如下错误时"),t("br"),s._v(" "),t("img",{attrs:{src:a(331),alt:""}})]),s._v(" "),t("p",[s._v("使用命令：")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ntfsfix "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" /dev/sdc1\n")])])]),t("h3",{attrs:{id:"reference"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[s._v("#")]),s._v(" reference")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://askubuntu.com/questions/462381/cant-mount-ntfs-drive-the-disk-contains-an-unclean-file-system",target:"_blank",rel:"noopener noreferrer"}},[s._v("1.https://askubuntu.com/questions/462381/cant-mount-ntfs-drive-the-disk-contains-an-unclean-file-system"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);