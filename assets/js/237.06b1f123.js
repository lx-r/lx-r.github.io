(window.webpackJsonp=window.webpackJsonp||[]).push([[237],{552:function(_,a,e){"use strict";e.r(a);var s=e(17),t=Object(s.a)({},(function(){var _=this,a=_._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[a("h1",{attrs:{id:"ldd-nm命令及elf文件及ld-library-path环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ldd-nm命令及elf文件及ld-library-path环境变量"}},[_._v("#")]),_._v(" ldd/nm命令及"),a("code",[_._v("ELF")]),_._v("文件及"),a("code",[_._v("LD_LIBRARY_PATH")]),_._v("环境变量")]),_._v(" "),a("h2",{attrs:{id:"命令介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令介绍"}},[_._v("#")]),_._v(" 命令介绍")]),_._v(" "),a("p",[a("code",[_._v("ldd")]),_._v("即"),a("code",[_._v("list dynamic dependencies")]),_._v(",其作用是列出"),a("code",[_._v("target")]),_._v("的动态链接库目录"),a("code",[_._v("RPATH")]),_._v("。")]),_._v(" "),a("p",[a("code",[_._v("RPATH")]),_._v("即硬编码在可执行文件或者动态库中的一个或多个路径，被动态链接加载器用来搜索依赖库。")]),_._v(" "),a("p",[_._v("如执行"),a("code",[_._v("ldd libxx.so")]),_._v("看到的如下信息，")]),_._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[_._v("libstdc++.so.6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[_._v(">")]),_._v(" /lib/x86_64-linux-gnu/libstdc++.so.6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("0x00007ff3ee589000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v("\nlibc.so.6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[_._v(">")]),_._v(" /lib/x86_64-linux-gnu/libc.so.6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("0x00007ff3ee397000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v("\n")])])]),a("p",[_._v("如果"),a("code",[_._v("ldd")]),_._v("查看到"),a("code",[_._v("target")]),_._v("中某个动态链接库为"),a("code",[_._v("not found")]),_._v(",")]),_._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[_._v("ldd test_cmake \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[_._v("# linux-vdso.so.1 (0x00007ffe97ea8000)")]),_._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[_._v("# libhello-cmake.so => not found")]),_._v("\n")])])]),a("p",[_._v("说明目标文件中没有"),a("code",[_._v("RPATH")]),_._v("信息,这种情况有可能是编译时关闭了添加"),a("code",[_._v("RPATH")]),_._v("选项,如"),a("code",[_._v("CMAKE")]),_._v("中设置"),a("code",[_._v("set(CMAKE_SKIP_RPATH TRUE)")]),_._v("。")]),_._v(" "),a("p",[_._v("可以设置"),a("code",[_._v("LD_LIBRARY_PATH")]),_._v("来指定，并在之后使用"),a("code",[_._v("ldconfig")]),_._v("使配置生效。")]),_._v(" "),a("p",[_._v("至于搜索路径，除了 "),a("code",[_._v("RPATH")]),_._v("，链接加载器在 "),a("code",[_._v("Linux")]),_._v(" 中，还会有另外几个关键的路径，他们的搜索顺序如下：")]),_._v(" "),a("ul",[a("li",[a("code",[_._v("RPATH")]),_._v("搜索优先级别在"),a("code",[_._v("LD_LIBRARY_PATH")]),_._v("系统变量之前。")]),_._v(" "),a("li",[a("code",[_._v("LD_LIBRARY_PATH")]),_._v("：环境变量，也是一个或多个路径；")]),_._v(" "),a("li",[a("code",[_._v("RUNPATH")]),_._v("： 与 "),a("code",[_._v("RPATH")]),_._v(" 一样，但是搜索顺序在 "),a("code",[_._v("LD_LIBRARY_PATH")]),_._v(" 后面，只在比较新的系统中被支持；")])]),_._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v("export")]),_._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[_._v("LD_LIBRARY_PATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[_._v("${LD_LIBRARY_PATH}")]),_._v(":/xx/abx/libabx.so\n"),a("span",{pre:!0,attrs:{class:"token function"}},[_._v("sudo")]),_._v(" ldconfig\n")])])]),a("h2",{attrs:{id:"nm命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nm命令"}},[_._v("#")]),_._v(" nm命令")]),_._v(" "),a("p",[a("code",[_._v("nm")]),_._v("命令也可以获取库函数的信息；")]),_._v(" "),a("p",[a("code",[_._v("nm")]),_._v("命令可以列出一个函数库文件中的符号表，它对静态的库函数和共享的库函数都能起作用。")]),_._v(" "),a("h2",{attrs:{id:"elf格式文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elf格式文件"}},[_._v("#")]),_._v(" ELF格式文件")]),_._v(" "),a("p",[a("code",[_._v("ELF文件（Executable Linkable Format）")]),_._v("是一种文件存储格式。Linux下的目标文件和可执行文件都按照该格式进行存储。")]),_._v(" "),a("ul",[a("li",[a("code",[_._v("可重定位目标文件")]),_._v("包含二进制代码和数据，其形式可以和其他目标文件进行合并，创建一个可执行目标文件。例如.o文件")]),_._v(" "),a("li",[a("code",[_._v("可执行目标文件")]),_._v("包含二进制代码和数据，可直接被加载器加载执行。例如编译好的可执行文件"),a("code",[_._v("a.out")]),_._v("。")]),_._v(" "),a("li",[a("code",[_._v("共享对象文件")]),_._v(",用于和其他共享目标文件或者可重定位文件一起生成ELF目标文件或者和执行文件一起创建进程映像,例如"),a("code",[_._v(".so")]),_._v("文件。")])]),_._v(" "),a("p",[_._v("使用"),a("code",[_._v("readelf")]),_._v("命令可以查看节头表内容。")])])}),[],!1,null,null,null);a.default=t.exports}}]);