(window.webpackJsonp=window.webpackJsonp||[]).push([[240],{553:function(t,s,e){"use strict";e.r(s);var n=e(17),a=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ntfsfix命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ntfsfix命令"}},[t._v("#")]),t._v(" ntfsfix命令")]),t._v(" "),s("h2",{attrs:{id:"问题背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题背景"}},[t._v("#")]),t._v(" 问题背景")]),t._v(" "),s("p",[t._v("最近遇到了一个什么问题呢，linux自动挂载硬盘后，变成了只读文件系统，无法创建和修改文件"),s("br"),t._v("\n查看挂载信息，")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" data\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /dev/sdb3 on /media/lx/data type fuseblk (rw,nosuid,nodev,relatime,user_id=0,group_id=0,default_permissions,allow_other,blksize=4096,uhelper=udisks2)")]),t._v("\n\n")])])]),s("p",[t._v("手动umount然后mount时报错，")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The disk contains an unclean file system (0, 0).")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Metadata kept in Windows cache, refused to mount.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Falling back to read-only mount because the NTFS partition is in an")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# unsafe state. Please resume and shutdown Windows fully (no hibernation")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or fast restarting.)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Could not mount read-write, trying read-only")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ntfs-3g-mount: failed to access mountpoint /media/lx/data: No such file or directory")]),t._v("\n\n")])])]),s("p",[t._v("以上报错的背景是，这个电脑是双系统，这个分区在"),s("code",[t._v("windows")]),t._v("下也能访问，从报错信息来看是"),s("code",[t._v("Metadata kept in Windows cache, refused to mount.")]),t._v("磁盘的元数据没有被正常的释放。查了很多资料都没有讲明白。")]),t._v(" "),s("h2",{attrs:{id:"解决办法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[t._v("#")]),t._v(" 解决办法")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("ubuntu")]),t._v("论坛上搜到一个有用的回答"),s("code",[t._v("https://askubuntu.com/questions/462381/cant-mount-ntfs-drive-the-disk-contains-an-unclean-file-system")])]),t._v(" "),s("p",[s("strong",[t._v("使用"),s("code",[t._v("ntfsfix")]),t._v("命令来对有问题的分区进行修复")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ntfsfix /dev/sdb3\n")])])]),s("p",[t._v("修复后，再次挂载")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" /dev/sdb3 /media/mount_point\n")])])]),s("h2",{attrs:{id:"命令详解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令详解"}},[t._v("#")]),t._v(" 命令详解")]),t._v(" "),s("p",[s("code",[t._v("ntfsfix")]),t._v("是一个用于修复NTFS文件系统的命令行工具，属于"),s("code",[t._v("ntfs-3g")]),t._v("软件包。它主要用于在"),s("code",[t._v("Linux")]),t._v("环境中处理"),s("code",[t._v("NTFS")]),t._v("分区的常见问题，尤其是在"),s("code",[t._v("Windows")]),t._v("系统未正常关机后，导致"),s("code",[t._v("NTFS")]),t._v("分区出现不一致或“脏”标志的情况。")]),t._v(" "),s("p",[t._v("ntfsfix命令可以执行以下操作：")]),t._v(" "),s("ul",[s("li",[t._v("修复基本的NTFS不一致性")]),t._v(" "),s("li",[t._v("重置NTFS日志文件")]),t._v(" "),s("li",[t._v("清除“脏”标志，使得NTFS分区可以在Linux下正常挂载"),s("br"),t._v("\n安装方法"),s("br"),t._v("\n在使用ntfsfix之前，需要确保ntfs-3g软件包已安装。可以通过以下命令在Ubuntu或Debian系统上安装：")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ntfs-3g\n")])])]),s("p",[s("code",[t._v("NTFS（New Technology File System）")]),t._v("是由微软开发的一种文件系统，主要用于"),s("code",[t._v("Windows NT")]),t._v("及其后续版本（如"),s("code",[t._v("Windows 2000")]),t._v("、"),s("code",[t._v("XP")]),t._v("、"),s("code",[t._v("Vista")]),t._v("、7、8和10）。它于1993年首次引入，旨在取代较旧的"),s("code",[t._v("FAT")]),t._v("（File Allocation Table）文件系统，提供更高的性能、可靠性和安全性。")]),t._v(" "),s("h3",{attrs:{id:"reference"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[t._v("#")]),t._v(" reference")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://askubuntu.com/questions/462381/cant-mount-ntfs-drive-the-disk-contains-an-unclean-file-system",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.https://askubuntu.com/questions/462381/cant-mount-ntfs-drive-the-disk-contains-an-unclean-file-system"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=a.exports}}]);