(window.webpackJsonp=window.webpackJsonp||[]).push([[249],{568:function(t,a,s){"use strict";s.r(a);var e=s(17),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"docker-run-gpus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-run-gpus"}},[t._v("#")]),t._v(" "),a("code",[t._v("docker run --gpus")])]),t._v(" "),a("h2",{attrs:{id:"命令介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令介绍"}},[t._v("#")]),t._v(" 命令介绍")]),t._v(" "),a("p",[a("code",[t._v("sudo docker run --gpus")]),t._v("命令是指定当前"),a("code",[t._v("docker")]),t._v("容器所能使用的"),a("code",[t._v("gpus")]),t._v(","),a("br"),t._v("\n当指定为"),a("code",[t._v("all")]),t._v("时，可以使用"),a("code",[t._v("host")]),t._v("上的所有"),a("code",[t._v("gpu")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--gpus")]),t._v(" all "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),a("h2",{attrs:{id:"常见问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v('could not select device driver "" with capabilities: [[gpu]]')])])]),t._v(" "),a("p",[t._v("这是因为没有安装"),a("code",[t._v("NVIDIA Container Toolkit")]),t._v("所导致的，可以参考官方的指导安装"),a("code",[t._v("nvidia-docker")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" nvidia-container-toolkit\n")])])]),a("p",[t._v("有时候，上面命令会报出如下错误，")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v('Unable to locate package nvidia-container-toolkit" on Debian x86_64')])])]),t._v(" "),a("p",[t._v("这种情况是当前源列表中找不到"),a("code",[t._v("nvidia-container-toolkit")]),t._v("所导致。")]),t._v(" "),a("p",[t._v("官方文档给出的解决办法为：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("distribution")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" /etc/os-release"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" $ID$VERSION_ID"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-fsSL")]),t._v(" https://nvidia.github.io/libnvidia-container/gpgkey "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" gpg "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dearmor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-L")]),t._v(" https://nvidia.github.io/libnvidia-container/experimental/"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$distribution")]),t._v("/libnvidia-container.list "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tee")]),t._v(" /etc/apt/sources.list.d/nvidia-container-toolkit.list\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" nvidia-container-toolkit\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" nvidia-ctk runtime configure "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--runtime")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--runtime")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nvidia "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--gpus")]),t._v(" all nvidia/cuda:11.6.2-base-ubuntu20.04 nvidia-smi\n")])])]),a("InArticleAdsense",{attrs:{"data-ad-client":"ca-pub-8685746128991385","data-ad-slot":"2974191661"}}),t._v(" "),a("blockquote",[a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/NVIDIA/nvidia-docker/issues/1034#issuecomment-520282450%5B/url%5D",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.https://github.com/NVIDIA/nvidia-docker/issues/1034#issuecomment-520282450%5B/url%5D"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/NVIDIA/nvidia-docker/issues/1238",target:"_blank",rel:"noopener noreferrer"}},[t._v("2.https://github.com/NVIDIA/nvidia-docker/issues/1238"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html#",target:"_blank",rel:"noopener noreferrer"}},[t._v("3.https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html#"),a("OutboundLink")],1)])])])],1)}),[],!1,null,null,null);a.default=n.exports}}]);