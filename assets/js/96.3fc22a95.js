(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{416:function(t,e,_){"use strict";_.r(e);var v=_(17),n=Object(v.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"_1-c-标准库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-c-标准库"}},[t._v("#")]),t._v(" 1."),e("code",[t._v("C++")]),t._v("标准库")]),t._v(" "),e("p",[e("code",[t._v("C++")]),t._v("标准库是"),e("code",[t._v("C++")]),t._v("标准中规定的"),e("code",[t._v("C++")]),t._v("语言必须实现的"),e("code",[t._v("库函数API")]),t._v(",c++标准库的标准化始于1989年，由国际标准化组织（the International Organization for Standardization,ISO)推动制定。")]),t._v(" "),e("p",[e("code",[t._v("ISO 14882")]),t._v("标准中，在条款20到33和附加章节D中定义的"),e("code",[t._v("C++")]),t._v("应该实现的内容。"),e("br"),t._v("\n这部分内容是"),e("code",[t._v("C++")]),t._v("标准库应该要实现的内容。有了这个标准定义，世界上各个组织才能实现具体的"),e("code",[t._v("C++")]),t._v("标准库。"),e("code",[t._v("C++")]),t._v("标准库的实现必须依赖操作系统所提供的函数（读写文件，内存分配，线程创建等系统调用）来实现标准库，因此每一个操作系统都有自己的标准库实现，有时它是系统的一个核心部分，有时它作为附加部分——编译器，必须单独下载安装。")]),t._v(" "),e("p",[t._v("有影响力的组织及其实现有3个："),e("code",[t._v("GNU的libstdc++")]),t._v("、"),e("code",[t._v("LLVM的libc++")]),t._v("、其他。")]),t._v(" "),e("ul",[e("li",[t._v("在"),e("code",[t._v("GNU/Linux")]),t._v("上，我们使用的"),e("code",[t._v("C++")]),t._v("库都是GNU实现的"),e("code",[t._v("libstdc++（/usr/lib/gcc/x86_64-linux-gnu/9/libstdc++.so、/usr/lib/gcc/x86_64-linux-gnu/9/libstdc++.a）")]),t._v(","),e("strong",[t._v("默认情况下，所有常用的Linux发行版都将使用"),e("code",[t._v("libstdc++")])])]),t._v(" "),e("li",[t._v("在"),e("code",[t._v("MacOS")]),t._v("、"),e("code",[t._v("iOS")]),t._v("上，我们使用的"),e("code",[t._v("C++")]),t._v("库都是"),e("code",[t._v("LLVM")]),t._v("项目实现的"),e("code",[t._v("libc++（/usr/lib/libc++.dylib）")])]),t._v(" "),e("li",[t._v("在"),e("code",[t._v("Android")]),t._v("上，我们使用的"),e("code",[t._v("C++")]),t._v("库为"),e("code",[t._v("LLVM")]),t._v("的"),e("code",[t._v("libc++")]),t._v("（NDK r18以前还是支持GNU的libstdc++的，在r18上被完全去除）；注意这可不是系统库，你需要将库文件包含在apk中（Android上的系统库是/system/lib/libstdc++.so，这不是GNU的那个，只包含了最小的C++ runtime实现，如new delete等）；")]),t._v(" "),e("li",[t._v("在Windows中，标准库的实现一直严格绑定到Visual Studio中。他们称其为 C/C++ Run-time Library(CRT)，其中同时实现了C和C++标准库")])]),t._v(" "),e("p",[e("code",[t._v("g++")]),t._v("编译时带上"),e("code",[t._v("-v")]),t._v("参数，日志就会清楚的显示编译的时候默认使用了什么库。")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[t._v("g"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v preprocessor_test"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("o main\n")])])]),e("ul",[e("li",[t._v("动态编译")])]),t._v(" "),e("p",[t._v("程序编译完成之后已经成为了"),e("code",[t._v("ELF")]),t._v("文件，这个时候它就可以在"),e("code",[t._v("Linux")]),t._v("上被执行了,由于我们的程序默认链接的是动态库，因此在运行时会对包括C++标准库在内的一些动态库产生依赖，使用ldd命令可以看到这些依赖:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("ldd main\n        linux-vdso.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0x00007ffde61c6000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        libstdc++.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/x86_64-linux-gnu/libstdc++.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0x00007f94c658e000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/x86_64-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0x00007f94c639c000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        libm.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/x86_64-linux-gnu/libm.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0x00007f94c624d000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        /lib64/ld-linux-x86-64.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0x00007f94c67ba000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        libgcc_s.so.1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/x86_64-linux-gnu/libgcc_s.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0x00007f94c6232000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("ul",[e("li",[t._v("静态编译")])]),t._v(" "),e("p",[t._v("如果想静态链接的话，加上"),e("code",[t._v("-static")]),t._v("关键字,")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("g++ "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-static")]),t._v(" gemfield.cpp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" gemfield\n")])])]),e("p",[t._v("如此一来，这个库在运行的时候就不依赖任何库了，但不推荐这么做，bug fix, 物理内存占用、安全相关功能将无法使用等。")]),t._v(" "),e("p",[t._v("不是每个系统上的C++编译都使用了标准的C++特性。这里的系统主要是手机操作系统，比如Android。ndk-build可能默认将异常、RTTI等功能停用")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("所有的Linux库都必须以lib开头")])])]),t._v(" "),e("p",[e("strong",[t._v("不使用标准库十分简单：只要不引入任何它的头文件即可")]),t._v(",在为嵌入式系统编程的时候也不会想包含标准库。")]),t._v(" "),e("p",[t._v("总结："),e("code",[t._v("C++")]),t._v("标准库是编译器或操作系统对"),e("code",[t._v("ISO C++")]),t._v("标准的实现，其实现涉及到系统调用、汇编编写硬件接口程序等，因此，不同平台的C++标准库实现方式不同，但对于程序开发者无感知，使用标准库可开发跨平台可移植的程序。")]),t._v(" "),e("h2",{attrs:{id:"_2-c-编译器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-c-编译器"}},[t._v("#")]),t._v(" 2."),e("code",[t._v("C++")]),t._v("编译器")]),t._v(" "),e("p",[t._v("总结："),e("code",[t._v("C++")]),t._v("编译器也是对"),e("code",[t._v("C++")]),t._v("标准的一种实现，作用是将开发者编写的"),e("code",[t._v("C++")]),t._v("源码转换成机器可执行的二进制程序。")]),t._v(" "),e("p",[t._v("我们常用的编译器一般有"),e("code",[t._v("Visual Studio(Windows),MSVC")]),t._v("，"),e("code",[t._v("Xcode(OS)")]),t._v("，"),e("code",[t._v("GCC(Unix)")]),t._v(", "),e("code",[t._v("LLVM的clang")]),t._v("等，其中"),e("code",[t._v("GCC")]),t._v(" 原本叫"),e("code",[t._v("GNU C Compiler")]),t._v(",后来亦集成了其他语言的编译器，故称为"),e("code",[t._v("GNU Compiler Collection")]),t._v(",其中"),e("code",[t._v("g++")]),t._v("正是"),e("code",[t._v("gcc")]),t._v("中的"),e("code",[t._v("C++")]),t._v("编译器。"),e("code",[t._v("LLVM")]),t._v("是与"),e("code",[t._v("gcc")]),t._v("平行的模块化和可重用的编译器和工具链技术集合，"),e("code",[t._v("clang")]),t._v("是"),e("code",[t._v("LLVM")]),t._v("原生的"),e("code",[t._v("C/C++/Objective-C")]),t._v("编译器。"),e("code",[t._v("gcc")]),t._v("开源协议基于"),e("code",[t._v("gplv3")]),t._v(","),e("code",[t._v("LLVM")]),t._v("开源协议基于"),e("code",[t._v("Apache 2.0")]),t._v(",因此越来越多的厂商选择"),e("code",[t._v("LLVM")]),t._v("。"),e("strong",[t._v("‵LLVM/GCC‵通常用于"),e("code",[t._v("UNIX/MacOS")]),t._v("平台，"),e("code",[t._v("MSVC")]),t._v("通常用于"),e("code",[t._v("windows")]),t._v("平台。")])]),t._v(" "),e("p",[t._v("如果想在"),e("code",[t._v("windows")]),t._v("平台上使用"),e("code",[t._v("GCC")]),t._v("，可以借助"),e("code",[t._v("Cygwin")]),t._v("或"),e("code",[t._v("MinGW")]),t._v("。")]),t._v(" "),e("blockquote",[e("p",[e("a",{attrs:{href:"https://www.zhihu.com/question/22137175#:~:text=%E5%8C%BA%E5%88%AB%EF%BC%88%E5%B0%8F%E7%BB%93%EF%BC%89%EF%BC%9ACygwin%E6%98%AF,%E5%8F%AF%E4%BB%A5%E5%9C%A8Cygwin%20%E4%B8%8A%E8%BF%90%E8%A1%8C%E3%80%82",target:"_blank",rel:"noopener noreferrer"}},[t._v("引用自"),e("OutboundLink")],1)])]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("Cygwin")]),t._v("的目的是提供运行于 Windows 平台的类 Unix 环境（以 GNU 工具为代表）,为了达到这个目的,Cygwin 提供了一套抽象层dll，用于将部分 Posix 调用转换成 Windows 的 API 调用，实现相关功能。")])]),t._v(" "),e("li",[e("p",[t._v("MinGW，Minimalist GNU for Windows，用于开发原生（32位） Windows 应用的开发环境。它主要提供了针对 win32 应用的 GCC、GNU binutils 等工具，以及对等于 Windows SDK（的子集）的头文件和用于 MinGW 版本 linker 的库文件（so、a等，而不是 VC 的 lib）。MinGW 能够替代 cl 用于编译不包含 MFC 的、以 WinSDK 为主的 Windows 应用，并且编译出来的应用不依赖于第三方的模拟层支持，其运行时为大部分 Windows 标配的 msvcrt （故称原生 Windows 应用）。除此之外，MinGW 也支持 GCC 支持的其他语言。因为这些原因，"),e("strong",[t._v("MinGW 被许多 Linux 上发展起来的开发工具选择为 Windows 版本的默认编译器")]),t._v("，例如 CodeBlocks，例如 DevC++。")])]),t._v(" "),e("li",[e("p",[t._v("MSYS 是用于辅助 Windows 版 MinGW 进行命令行开发的配套软件包，提供了部分 Unix 工具以使得 MinGW 的工具使用起来方便一些。如果不喜欢庞大的 Cygwin，而且使用不多，可以试试。不过喜欢完整体验、不在乎磁盘占用等等，还是推荐 Cygwin 而不是 MSYS。")])])]),t._v(" "),e("p",[e("strong",[t._v("总结:")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("区别：Cygwin是模拟 POSIX 系统，源码移植 Linux 应用到 Windows 下；MinGW 是用于开发 Windows 应用的开发环境。")])]),t._v(" "),e("li",[e("p",[t._v("联系：均提供了部分 Linux 下的应用，多跑在 Windows 上；MinGW 作为 Cygwin 下的软件包，可以在 Cygwin  上运行。")])])]),t._v(" "),e("InArticleAdsense",{attrs:{"data-ad-client":"ca-pub-8685746128991385","data-ad-slot":"2974191661"}}),t._v(" "),e("h3",{attrs:{id:"参考资料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("a",{attrs:{href:"https://blog.csdn.net/lbw520/article/details/104585775",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.https://blog.csdn.net/lbw520/article/details/104585775"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/291496862",target:"_blank",rel:"noopener noreferrer"}},[t._v("2.https://zhuanlan.zhihu.com/p/291496862"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://llvm.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("3.https://llvm.org/"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.zhihu.com/question/20235742",target:"_blank",rel:"noopener noreferrer"}},[t._v("4.https://www.zhihu.com/question/20235742"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.zhihu.com/question/22137175#:~:text=%E5%8C%BA%E5%88%AB%EF%BC%88%E5%B0%8F%E7%BB%93%EF%BC%89%EF%BC%9ACygwin%E6%98%AF,%E5%8F%AF%E4%BB%A5%E5%9C%A8Cygwin%20%E4%B8%8A%E8%BF%90%E8%A1%8C%E3%80%82",target:"_blank",rel:"noopener noreferrer"}},[t._v("5.https://www.zhihu.com/question/22137175#:~:text=%E5%8C%BA%E5%88%AB%EF%BC%88%E5%B0%8F%E7%BB%93%EF%BC%89%EF%BC%9ACygwin%E6%98%AF,%E5%8F%AF%E4%BB%A5%E5%9C%A8Cygwin%20%E4%B8%8A%E8%BF%90%E8%A1%8C%E3%80%82"),e("OutboundLink")],1)])])])],1)}),[],!1,null,null,null);e.default=n.exports}}]);