(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{412:function(e,_,t){"use strict";t.r(_);var v=t(17),a=Object(v.a)({},(function(){var e=this,_=e._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h1",{attrs:{id:"elf文件及objdump-readelf命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#elf文件及objdump-readelf命令"}},[e._v("#")]),e._v(" ELF文件及objdump/readelf命令")]),e._v(" "),_("p",[e._v("ELF(Executable and Linked Format）是UNIX系统实验室（USL）作为应用程序二进制接口（Application Binary Interface）开发和发布的可执行链接格式。ELF文件是Linux目标文件格式既参与程序执行也参与程序链接。")]),e._v(" "),_("p",[e._v("可以从程序执行和程序链接两个角度来分析ELF文件：")]),e._v(" "),_("table",[_("thead",[_("tr",[_("th",[e._v("从链接角度")]),e._v(" "),_("th",[e._v("从执行角度")])])]),e._v(" "),_("tbody",[_("tr",[_("td",[e._v("ELF Header")]),e._v(" "),_("td",[e._v("ELF Header")])]),e._v(" "),_("tr",[_("td",[e._v("Program Header Table(Optional)")]),e._v(" "),_("td",[e._v("Program Header Table")])]),e._v(" "),_("tr",[_("td",[e._v("Section 1")]),e._v(" "),_("td",[e._v("Segment 1")])]),e._v(" "),_("tr",[_("td",[e._v("Section 2")]),e._v(" "),_("td",[e._v("Segment 2")])]),e._v(" "),_("tr",[_("td",[e._v("Section ...")]),e._v(" "),_("td",[e._v("Segment ...")])]),e._v(" "),_("tr",[_("td",[e._v("Section N")]),e._v(" "),_("td",[e._v("Segment N")])]),e._v(" "),_("tr",[_("td",[e._v("Section header table")]),e._v(" "),_("td",[e._v("Section header table(optional)")])])])]),e._v(" "),_("h2",{attrs:{id:"elf文件结构分析"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#elf文件结构分析"}},[e._v("#")]),e._v(" ELF文件结构分析")]),e._v(" "),_("p",[_("code",[e._v("ELF Header")]),e._v("部分位于文件的开头，包括用于标识文件是不是"),_("code",[e._v("ELF")]),e._v("文件的标识位，"),_("code",[e._v("program header")]),e._v("/"),_("code",[e._v("Section header")]),e._v("的偏移量，"),_("code",[e._v("program headers")]),e._v("个数，"),_("code",[e._v("section headers")]),e._v("个数等信息。")]),e._v(" "),_("p",[_("code",[e._v("program headers")]),e._v("记录了"),_("code",[e._v("segment")]),e._v("的分布，用来保存程序加载到内存中所需要的信息。因此从程序运行的角度来看是必须的。譬如其中"),_("code",[e._v("DYNAMIC")]),e._v("部分，指定了"),_("code",[e._v("ELF")]),e._v("文件加载时动态链接器需要的信息。")]),e._v(" "),_("p",[_("code",[e._v("section header")]),e._v("记录了"),_("code",[e._v("ELF")]),e._v("包含的哪些"),_("code",[e._v("section")]),e._v("及其位置。从文件链接角度来看，"),_("code",[e._v("Section")]),e._v("部分主要由"),_("code",[e._v("text\\data\\rodata\\bss")]),e._v("等不同部分组成。")]),e._v(" "),_("h2",{attrs:{id:"使用od命令读取elf文件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#使用od命令读取elf文件"}},[e._v("#")]),e._v(" 使用"),_("code",[e._v("od")]),e._v("命令读取"),_("code",[e._v("ELF")]),e._v("文件")]),e._v(" "),_("p",[_("code",[e._v("od")]),e._v("命令用于将指定文件内容以八进制、十进制、十六进制、浮点格式或ASCII编码字符方式显示。通常用于显示或查看文件中不能直接显示在终端的字符。od命令系统默认的显示方式是八进制，名称源于"),_("code",[e._v("Octal Dump")]),e._v("。")]),e._v(" "),_("p",[e._v("后面支持的参数：")]),e._v(" "),_("ul",[_("li",[_("code",[e._v("-A")]),e._v(",文件偏移量的输出格式，可选值为"),_("code",[e._v("doxn")]),e._v("之一，分别表示"),_("code",[e._v("decimal/octal/hex")]),e._v("和"),_("code",[e._v("none")]),e._v("。")]),e._v(" "),_("li",[_("code",[e._v("-t")]),e._v("输出的格式，如"),_("code",[e._v("-x1")]),e._v("用一个十六进制数表示的输出的值，类型后追加参数"),_("code",[e._v("z")]),e._v("会在每一行后输出对应十六进制数对应的可打印字符。")])]),e._v(" "),_("p",[e._v("更多"),_("code",[e._v("od")]),e._v("命令的使用方法可以参考"),_("code",[e._v("man od")]),e._v("手册，使用"),_("code",[e._v("od")]),e._v("命令查看"),_("code",[e._v("ELF")]),e._v("文件的方式如下：")]),e._v(" "),_("div",{staticClass:"language-sh extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sh"}},[_("code",[e._v("od "),_("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-t")]),e._v(" x1z "),_("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-A")]),e._v(" x tc\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000 7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00  >.ELF............<")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000010 02 00 3e 00 01 00 00 00 90 10 40 00 00 00 00 00  >..>.......@.....<")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000020 40 00 00 00 00 00 00 00 50 31 00 00 00 00 00 00  >@.......P1......<")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000030 00 00 00 00 40 00 38 00 0b 00 40 00 1b 00 1a 00  >....@.8...@.....<")]),e._v("\n")])])]),_("p",[e._v("十六进制数"),_("code",[e._v("7f 45 4c 46")]),e._v("对应的"),_("code",[e._v("Ascii")]),e._v("码分别是"),_("code",[e._v(".ELF")]),e._v("用来标识文件是"),_("code",[e._v("ELF")]),e._v("文件。")]),e._v(" "),_("h2",{attrs:{id:"使用readelf命令读取elf文件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#使用readelf命令读取elf文件"}},[e._v("#")]),e._v(" 使用"),_("code",[e._v("readelf")]),e._v("命令读取"),_("code",[e._v("ELF")]),e._v("文件")]),e._v(" "),_("p",[_("code",[e._v("readelf")]),e._v("命令是专门用来读取"),_("code",[e._v("ELF")]),e._v("文件中内容的命令。"),_("code",[e._v("readelf")]),e._v("命令和"),_("code",[e._v("objdump")]),e._v("提供的功能类似，但是它显示的信息更为具体。")]),e._v(" "),_("p",[_("code",[e._v("readelf")]),e._v("命令支持的参数选项：")]),e._v(" "),_("ul",[_("li",[_("code",[e._v("-h")]),e._v("打印"),_("code",[e._v("ELF Header")]),e._v("信息")]),e._v(" "),_("li",[_("code",[e._v("-l")]),e._v("打印"),_("code",[e._v("ELF")]),e._v("文件中的"),_("code",[e._v("program-headers|--segments")]),e._v("信息")]),e._v(" "),_("li",[_("code",[e._v("-S")]),e._v("打印"),_("code",[e._v("ELF")]),e._v("文件中的"),_("code",[e._v("--section-headers|--sections")]),e._v("信息")]),e._v(" "),_("li",[_("code",[e._v("-s")]),e._v("打印符号信息，符号指向一个语言层面的实体，如变量"),_("code",[e._v("Object")]),e._v("和函数"),_("code",[e._v("Func")]),e._v("。ELF文件中的符号表（symbol table）存放着前面提到的Elf64_Sym，表示该文件内已经定义或者需要引用的符号。")]),e._v(" "),_("li",[_("code",[e._v("-a")]),e._v("打印所有的"),_("code",[e._v("headers")]),e._v("信息")])]),e._v(" "),_("p",[e._v("使用示例：")]),e._v(" "),_("div",{staticClass:"language-sh extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sh"}},[_("code",[e._v("readelf "),_("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-r")]),e._v(" tc\n\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Relocation section '.rela.dyn' at offset 0x618 contains 3 entries:")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#   Offset          Info           Type           Sym. Value    Sym. Name + Addend")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000403ff0  000700000006 R_X86_64_GLOB_DAT 0000000000000000 __libc_start_main@GLIBC_2.2.5 + 0")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000403ff8  000800000006 R_X86_64_GLOB_DAT 0000000000000000 __gmon_start__ + 0")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000404080  000a00000005 R_X86_64_COPY     0000000000404080 _ZSt4cout@GLIBCXX_3.4 + 0")]),e._v("\n\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Relocation section '.rela.plt' at offset 0x660 contains 6 entries:")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#   Offset          Info           Type           Sym. Value    Sym. Name + Addend")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000404018  000900000007 R_X86_64_JUMP_SLO 0000000000401030 _ZSt4endlIcSt11char_tr@GLIBCXX_3.4 + 0")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000404020  000100000007 R_X86_64_JUMP_SLO 0000000000000000 _ZStlsISt11char_traits@GLIBCXX_3.4 + 0")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000404028  000200000007 R_X86_64_JUMP_SLO 0000000000000000 _Znwm@GLIBCXX_3.4 + 0")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000404030  000300000007 R_X86_64_JUMP_SLO 0000000000000000 _ZdlPvm@CXXABI_1.3.9 + 0")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000404038  000400000007 R_X86_64_JUMP_SLO 0000000000000000 _ZNSolsEPFRSoS_E@GLIBCXX_3.4 + 0")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 000000404040  000600000007 R_X86_64_JUMP_SLO 0000000000000000 _ZNSolsEi@GLIBCXX_3.4 + 0")]),e._v("\n")])])]),_("h2",{attrs:{id:"使用objdump命令分析elf文件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#使用objdump命令分析elf文件"}},[e._v("#")]),e._v(" 使用"),_("code",[e._v("objdump")]),e._v("命令分析"),_("code",[e._v("ELF")]),e._v("文件")]),e._v(" "),_("p",[_("code",[e._v("od")]),e._v("和"),_("code",[e._v("readelf")]),e._v("命令可以读取"),_("code",[e._v("ELF")]),e._v("文件中的信息，如果想看具体每一个"),_("code",[e._v("Section/Segment")]),e._v("部分的内容，可以使用"),_("code",[e._v("objdump")]),e._v("命令。该命令还能执行反汇编操作。")]),e._v(" "),_("p",[e._v("这里先说个题外话，"),_("code",[e._v("dump")]),e._v("单词的含义，这里是指"),_("code",[e._v("to move information from a computer's memory to another place or device")]),e._v("翻译过来是"),_("strong",[e._v("将内存信息转存")]),e._v("，如"),_("code",[e._v("coredump")]),e._v("文件。")]),e._v(" "),_("p",[_("code",[e._v("objdump")]),e._v("命令支持的参数选项：")]),e._v(" "),_("ul",[_("li",[e._v("‵-a`展示文件的头信息,类型")]),e._v(" "),_("li",[_("code",[e._v("-f")]),e._v("展示文件的头信息更详细")]),e._v(" "),_("li",[_("code",[e._v("-h")]),e._v("查看"),_("code",[e._v("ELF")]),e._v("支持哪些"),_("code",[e._v("Section")]),e._v("信息")]),e._v(" "),_("li",[_("code",[e._v("-j name")]),e._v("只展示名字为"),_("code",[e._v("name")]),e._v("的"),_("code",[e._v("Section")]),e._v("部分的信息。")]),e._v(" "),_("li",[e._v("‵-x"),_("code",[e._v("展示所有的")]),e._v("section`信息")]),e._v(" "),_("li",[_("code",[e._v("-d")]),e._v("反编译程序")]),e._v(" "),_("li",[_("code",[e._v("-s")]),e._v("展示指定"),_("code",[e._v("section")]),e._v("部分的所有信息")])]),e._v(" "),_("p",[e._v("使用：")]),e._v(" "),_("div",{staticClass:"language-sh extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sh"}},[_("code",[e._v("objdump "),_("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" tc\n\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# tc:     file format elf64-x86-64")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# architecture: i386:x86-64, flags 0x00000112:")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# EXEC_P, HAS_SYMS, D_PAGED")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# start address 0x0000000000401090")]),e._v("\n\nobjdump "),_("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-d")]),e._v(" "),_("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-S")]),e._v(" tc\n\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Disassembly of section .fini:")]),e._v("\n\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 00000000004012e8 <.fini>:")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#   4012e8:       f3 0f 1e fa             endbr64 ")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#   4012ec:       48 83 ec 08             sub    $0x8,%rsp")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#   4012f0:       48 83 c4 08             add    $0x8,%rsp")]),e._v("\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#   4012f4:       c3                      retq   ")]),e._v("\n")])])]),_("h3",{attrs:{id:"reference"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[e._v("#")]),e._v(" reference")]),e._v(" "),_("blockquote",[_("p",[_("a",{attrs:{href:"https://ivanzz1001.github.io/records/post/linuxops/2018/08/27/linux-od-comand",target:"_blank",rel:"noopener noreferrer"}},[e._v("1.https://ivanzz1001.github.io/records/post/linuxops/2018/08/27/linux-od-comand"),_("OutboundLink")],1),_("br"),e._v(" "),_("a",{attrs:{href:"https://www.bluepuni.com/archives/elf-symbols/",target:"_blank",rel:"noopener noreferrer"}},[e._v("2.https://www.bluepuni.com/archives/elf-symbols/"),_("OutboundLink")],1),_("br"),e._v(" "),_("a",{attrs:{href:"https://evshary.com/2018/05/06/ELF-format/",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.https://evshary.com/2018/05/06/ELF-format/"),_("OutboundLink")],1)])])])}),[],!1,null,null,null);_.default=a.exports}}]);